# Node.jsでgRPC通信

## 用語一覧
- [gRPC](https://engineering.mercari.com/blog/entry/20201216-53796c2494/)
- [Protocol Bufferss](https://ja.wikipedia.org/wiki/Protocol_Buffers)
- [HTTP/2](https://www.kagoya.jp/howto/it-glossary/security/http-2/)

## gRPC（Remote Procedure Calls） とは
```
Googleが開発したオープンソースのリモートプロシージャコール (RPC) システムである。gRPCは、HTTP/2をトランスポートとして利用し、Protocol Bufferssをインタフェース記述言語として利用する。認証や双方向のストリーミング、フロー制御、ブロッキングとノンブロッキングのバインディング、取り消しとタイムアウトといった機能を提供している。多くの言語でクロスプラットフォームのクライアントとサーバーのバインディングが利用できる。最も一般的な利用シナリオとしては、マイクロサービス型のアーキテクチャーにおける接続サービスや、モバイルデバイスの接続、バックエンドサービスへのブラウザーからの接続がある。

(gRPC開発の流れ)
・(.ptoro)ファイル作成スキーマ定義
・コード生成
・ロジック追加

(gRPCの通信の種類)
・普通の通信
　　１リクエスト　１レスポンス

・サーバーストリーミング
　　１リクエスト　複数レスポンス
　　ログインしたら幾度か通知を送るなどのpush通知

・クライアントストリーミング
　　複数リクエスト　１レスポンス
　　複数ファイルのアップロードなど
　　リアルタイム音声認識(speech-to-text)

・双方向ストリーミング
　　リアルタイムチャットシステム
```

## Protocol Bufferss とは
```
インタフェース定義言語 (IDL) で構造を定義する通信や永続化での利用を目的としたシリアライズフォーマットであり、Googleにより開発されている。XMLと比べ、3〜10倍小さく、20〜100倍高速で通信可能。
データ構造およびサービスはプロトコル定義ファイル (*.proto) でデザインされ、protocプログラムによりコンパイルされる。このコンパイル作業により目的のサービスに適合するコードが生成される。
```

## HTTP/2 とは
```
HTTP/1.1では、ウェブサーバーに対して原則1つずつしかリクエストを送ることしかできないがHTTP/2では、複数のリクエストを同時に処理することが可能。
HTTP/2では、一つのTCPコネクションを使い回し、 その中でHTTPリクエストとHTTPレスポンスを多重化することで、 複数のHTTP通信を上限なく並列的にやりとりすることが可能
```

# Setup

## install
```sh
$ npm install
```

## Usage
```sh
// Makefile内のprotogenコマンドを実行
$ make protogen

$ npm run dev
```